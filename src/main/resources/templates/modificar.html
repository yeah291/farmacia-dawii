<!DOCTYPE html>

<html lang="es"
      xmlns:th="http://www.thymeleaf.org"
      xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CRUD PRODUCTO</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
</head>
<body>




<div class="container">

  <br><br>
  <h1 th:text="*{metodo} + ' Producto'"></h1>
  <form th:action="@{/guardar}" method="post" class="needs-validation" novalidate th:object="${producto}" enctype="multipart/form-data" >
    <input type="hidden" th:field="*{idProducto}">
    <input type="hidden" th:field="*{idFoto}">
    <input type="hidden" name="metodo" th:value="${metodo}">
   
    <div class="mb-3">
      <label for="descripcion" class="form-label">Descripción del producto</label>
      <textarea type="text" class="form-control" th:field="*{descripcion}" id="descripcion"
                required placeholder="Ingrese la descripción"></textarea>
      <div class="invalid-feedback">Ingrese una descripción</div>
    </div>

    <div class="mb-3">
      <label for="precio" class="form-label">Precio</label>
      <input type="text" class="form-control" th:field="*{precio}" id="precio"
             pattern="([1-9]([0-9]+)*.[0-9][0-9]*)||(0.(([0-9][1-9])||([1-9][0-9])))" required placeholder="Ingrese el precio">
      <div class="invalid-feedback">Ingrese un precio mayor a  00.00</div>
    </div>
    
    <div class="mb-3">
      <label for="sotck" class="form-label">Stock</label>
      <input type="text" class="form-control" th:field="*{stock}" id="stock"
             pattern="([1-9])||([1-9][0-9]+)" required placeholder="Ingrese el sotck">
      <div class="invalid-feedback">Ingrese el stock mayor a 1</div>
    </div>
        
        
    <div class="mb-3">
      <label for="idCategoria" class="form-label">Categoría</label>
      <select id="idCategoria" th:field="*{idCategoria}" class="form-select" required >
        <!--<option value="-1" selected>Seleccione</option>-->
        <option th:each="c : ${lstCategorias}"
        th:value="${c.idCategoria}"
        th:text="${c.nomcat}"
        ></option>
     </select>
      <div class="invalid-feedback">Seleccione una categoría</div>
    </div>

    <div th:if="${metodo} == 'Agregar'" class="mb-3">
      <label for="foto" class="form-label">Foto</label>
      <input type="file" class="form-control" id="foto" name="file"
             required placeholder="Agrege una foto"
             accept="image/jpeg, image/png">
      <div class="invalid-feedback">Seleccione una foto</div>
    </div>

    <div th:if="${metodo} == 'Editar'" class="mb-3">
      <label for="foto" class="form-label">Foto</label>
      <input type="file" class="form-control" id="foto" name="file"
             placeholder="Agrege una foto"
             accept="image/jpeg, image/png">
      <div class="invalid-feedback">Seleccione una foto</div>
    </div>

    <button th:if="${metodo} == 'Agregar'" type="submit" class="btn btn-primary">Agregar</button>
    <button th:if="${metodo} == 'Editar'" type="submit" class="btn btn-warning">Editar</button>
    <a type="button" class="btn btn-light" th:href="@{/}">Regresar</a>

  </form>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
<script type="text/javascript">
  // Example starter JavaScript for disabling form submissions if there are invalid fields
  (() => {
    'use strict';

    // Fetch all the forms we want to apply custom Bootstrap validation styles to
    const forms = document.querySelectorAll('.needs-validation');

    // Loop over them and prevent submission
    Array.from(forms).forEach(form => {
      form.addEventListener('submit', event => {
        if (!form.checkValidity()) {
          event.preventDefault();
          event.stopPropagation();
        }

        form.classList.add('was-validated');
      }, false);
    });
  })();
</script>
</body>
</html>